"use strict";
/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.
 * Apache-2.0 */
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Serialize an item into a json format accepted by the Portal API
 * for create and update operations
 *
 * @param item Item to be serialized
 * @returns a formatted json object to be sent to Portal
 */
function serializeItem(item) {
    // create a clone so we're not messing with the original
    var clone = JSON.parse(JSON.stringify(item));
    // join keywords and tags...
    var _a = item.typeKeywords, typeKeywords = _a === void 0 ? [] : _a, _b = item.tags, tags = _b === void 0 ? [] : _b;
    clone.typeKeywords = typeKeywords.join(", ");
    clone.tags = tags.join(", ");
    // convert .data to .text
    if (clone.data) {
        clone.text = JSON.stringify(clone.data);
        delete clone.data;
    }
    // Convert properties to a string
    if (clone.properties) {
        clone.properties = JSON.stringify(clone.properties);
    }
    return clone;
}
exports.serializeItem = serializeItem;
/**
 * requestOptions.owner is given priority, requestOptions.item.owner will be checked next. If neither are present, authentication.username will be assumed.
 */
function determineOwner(requestOptions) {
    if (requestOptions.owner) {
        return requestOptions.owner;
    }
    if (requestOptions.item && requestOptions.item.owner) {
        return requestOptions.item.owner;
    }
    else {
        return requestOptions.authentication.username;
    }
}
exports.determineOwner = determineOwner;
//# sourceMappingURL=helpers.js.map